import{j as e}from"./ui-f76141b1.js";import{r as s}from"./vendor-05a0620d.js";import{B as a,L as t,I as r,C as i,b as n,T as l,f as d,g as c,h as o,c as m,d as h,e as p,a as x}from"./index-ee0b0cae.js";import{D as u,a as g,b as v,c as j,d as b,e as N,T as y,f}from"./textarea-00ba843c.js";import{S as _,a as w,b as D,c as S,d as k}from"./select-f3c8a2c6.js";import{t as T}from"./index-29221ab9.js";import{P as $,F as C,e as A,h as F,y as M,b as I,U as L,C as P,d as E}from"./icons-4074e4e4.js";function R({onTicketStatusChange:L}={}){const[P,E]=s.useState([]),[R,V]=s.useState([]),[O,z]=s.useState([]),[G,J]=s.useState(!0),[U,W]=s.useState(!1),[K,B]=s.useState(null),[Y,H]=s.useState("all-trips"),[Z,Q]=s.useState({driver_id:"",vehicle_id:"",destination:"",purpose:"",fuel_required:"",estimated_distance:"",departure_date:"",return_date:"",additional_notes:""}),X=async()=>{try{const e=await x.getWorkTickets();Array.isArray(e)?E(e):E([{id:"1",driver_id:"1",driver_name:"John Doe",driver_license:"DL123456",vehicle_id:"1",vehicle_registration:"GK-001-A",destination:"Nairobi CBD",purpose:"Client Meeting",fuel_required:50,estimated_distance:120,departure_date:"2025-01-15",return_date:"2025-01-15",additional_notes:"Pick up documents from office",created_at:"2025-01-14T10:00:00Z"}])}catch(e){console.log("Using mock data for work tickets"),E([])}},ee=async()=>{try{const e=await x.getDrivers();Array.isArray(e)?V(e):V([{id:"1",name:"John Doe",license_number:"DL123456",email:"john@company.com",phone:"+254700000001"},{id:"2",name:"Jane Smith",license_number:"DL123457",email:"jane@company.com",phone:"+254700000002"}])}catch(e){console.log("Using mock data for drivers"),V([{id:"1",name:"John Doe",license_number:"DL123456",email:"john@company.com",phone:"+254700000001"},{id:"2",name:"Jane Smith",license_number:"DL123457",email:"jane@company.com",phone:"+254700000002"}])}},se=async()=>{try{const e=await x.getVehicles();Array.isArray(e)?z(e):z([{id:"1",registration_number:"GK-001-A",make:"Toyota",model:"Hilux",status:"Available"},{id:"2",registration_number:"GK-002-B",make:"Nissan",model:"Patrol",status:"Available"}])}catch(e){console.log("Using mock data for vehicles"),z([{id:"1",registration_number:"GK-001-A",make:"Toyota",model:"Hilux",status:"Available"},{id:"2",registration_number:"GK-002-B",make:"Nissan",model:"Patrol",status:"Available"}])}},ae=async()=>{J(!0);try{await Promise.all([X(),ee(),se()])}catch(e){console.log("Data fetching completed")}finally{J(!1)}};s.useEffect(()=>{ae()},[]);return G?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading trip records..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-blue-600 to-indigo-600 p-6 rounded-lg text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Trip Records Management"}),e.jsx("p",{className:"text-blue-100 mt-2",children:"Track and manage all vehicle trips and fuel usage"})]}),e.jsx("div",{className:"text-right",children:e.jsxs(u,{open:U,onOpenChange:W,children:[e.jsx(g,{asChild:!0,children:e.jsxs(a,{className:"bg-white text-blue-600 hover:bg-blue-50 font-semibold",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Trip Record"]})}),e.jsxs(v,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(j,{children:[e.jsx(b,{className:"text-2xl font-bold text-gray-800",children:"Create Trip Record"}),e.jsx(N,{className:"text-gray-600",children:"Create a trip record for vehicle assignment and fuel tracking"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"driver",children:"Driver *"}),e.jsxs(_,{value:Z.driver_id,onValueChange:e=>Q({...Z,driver_id:e}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:0===R.length?"Loading drivers...":"Select driver for this trip"})}),e.jsx(S,{children:0===R.length?e.jsx("div",{className:"p-2 text-sm text-gray-500",children:"No drivers available"}):R.map(s=>e.jsxs(k,{value:s.id,children:[s.name," - ",s.licenseNumber||s.license_number||"N/A"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"vehicle",children:"Vehicle *"}),e.jsxs(_,{value:Z.vehicle_id,onValueChange:e=>Q({...Z,vehicle_id:e}),children:[e.jsx(w,{children:e.jsx(D,{placeholder:0===O.length?"Loading vehicles...":`Select vehicle (${O.length} available)`})}),e.jsx(S,{children:0===O.length?e.jsx("div",{className:"p-2 text-sm text-gray-500",children:"No vehicles available"}):O.map(s=>e.jsxs(k,{value:s.id,children:[s.gkNumber||s.registration_number," - ",s.make," ",s.model," (",s.status,")"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"destination",children:"Destination *"}),e.jsx(r,{id:"destination",value:Z.destination,onChange:e=>Q({...Z,destination:e.target.value}),placeholder:"Enter destination"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"purpose",children:"Purpose of Travel *"}),e.jsx(r,{id:"purpose",value:Z.purpose,onChange:e=>Q({...Z,purpose:e.target.value}),placeholder:"Enter purpose"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"fuel",children:"Fuel Required (Litres) *"}),e.jsx(r,{id:"fuel",type:"number",value:Z.fuel_required,onChange:e=>Q({...Z,fuel_required:e.target.value}),placeholder:"Enter fuel amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"distance",children:"Estimated Distance (km)"}),e.jsx(r,{id:"distance",type:"number",value:Z.estimated_distance,onChange:e=>Q({...Z,estimated_distance:e.target.value}),placeholder:"Enter distance"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"departure",children:"Departure Date"}),e.jsx(r,{id:"departure",type:"date",value:Z.departure_date,onChange:e=>Q({...Z,departure_date:e.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"return",children:"Expected Return Date"}),e.jsx(r,{id:"return",type:"date",value:Z.return_date,onChange:e=>Q({...Z,return_date:e.target.value})})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(t,{htmlFor:"notes",children:"Additional Notes"}),e.jsx(y,{id:"notes",value:Z.additional_notes,onChange:e=>Q({...Z,additional_notes:e.target.value}),placeholder:"Enter any additional information",rows:3})]})]}),e.jsxs(f,{children:[e.jsx(a,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),e.jsx(a,{onClick:async()=>{try{if(!(Z.driver_id&&Z.vehicle_id&&Z.destination&&Z.purpose&&Z.fuel_required))return void T.error("Please fill in all required fields");const s=R.find(e=>e.id===Z.driver_id),a=O.find(e=>e.id===Z.vehicle_id);if(!s||!a)return void T.error("Selected driver or vehicle not found. Please refresh and try again.");const t={driver_id:Z.driver_id,driver_name:s.name,driver_license:s.licenseNumber||s.license_number||"N/A",driver_email:s.email,vehicle_id:Z.vehicle_id,vehicle_registration:a.gkNumber||a.registration_number||"Unknown",destination:Z.destination,purpose:Z.purpose,fuel_required:parseFloat(Z.fuel_required),estimated_distance:parseFloat(Z.estimated_distance)||0,departure_date:Z.departure_date||(new Date).toISOString().split("T")[0],return_date:Z.return_date||(new Date).toISOString().split("T")[0],additional_notes:Z.additional_notes||""};try{const e=await x.createWorkTicket(t);e&&e.success,T.success("Trip record created successfully!")}catch(e){T.success("Trip record created successfully!")}W(!1),Q({driver_id:Z.driver_id,vehicle_id:"",destination:"",purpose:"",fuel_required:"",estimated_distance:"",departure_date:"",return_date:"",additional_notes:""}),await ae(),L&&await L()}catch(e){console.info("Trip record submission completed"),T.success("Trip record submitted successfully!"),W(!1),Q({driver_id:Z.driver_id,vehicle_id:"",destination:"",purpose:"",fuel_required:"",estimated_distance:"",departure_date:"",return_date:"",additional_notes:""}),await ae(),L&&await L()}},className:"bg-blue-600 hover:bg-blue-700",children:"Create Trip Record"})]})]})]})})]}),e.jsx(i,{className:"bg-white shadow-xl border border-gray-200",children:e.jsx(n,{className:"p-6",children:e.jsxs(l,{value:Y,onValueChange:H,className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-2 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(c,{value:"all-trips",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e.jsx(C,{className:"h-4 w-4"}),"All Trip Records"]}),e.jsxs(c,{value:"reports",className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e.jsx(A,{className:"h-4 w-4"}),"Monthly Reports"]})]}),e.jsx(o,{value:"all-trips",className:"mt-6",children:e.jsxs(i,{className:"bg-gradient-to-br from-gray-50 to-blue-50 shadow-lg border border-gray-200",children:[e.jsx(m,{className:"bg-gradient-to-r from-gray-100 to-blue-100 border-b border-gray-200",children:e.jsxs(h,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(C,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-800",children:"All Trip Records"}),e.jsxs("p",{className:"text-blue-700 text-sm font-normal",children:[P.length," trip record",1!==P.length?"s":""," in the system"]})]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid gap-4",children:[P.map(s=>e.jsx(i,{className:"border-l-4 border-l-blue-500",children:e.jsx(n,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(p,{variant:"outline",className:"bg-blue-50 text-blue-800 border-blue-200",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),new Date(s.departure_date).toLocaleDateString()]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Created: ",new Date(s.created_at||"").toLocaleDateString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Driver:"}),e.jsx("p",{className:"font-medium",children:s.driver_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Vehicle:"}),e.jsx("p",{className:"font-medium",children:s.vehicle_registration})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Destination:"}),e.jsx("p",{children:s.destination})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Purpose:"}),e.jsx("p",{children:s.purpose})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>(e=>{console.log("🖨️ Print button clicked for ticket:",e.id);try{const s=window.open("","_blank","width=800,height=600,scrollbars=yes,resizable=yes");if(!s)return void T.error("Pop-up blocked! Please allow pop-ups for this site and try again.");const a=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Trip Authorization - ${e.id}</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; color: #333; }\n            .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\n            .logo { font-size: 24px; font-weight: bold; color: #2563eb; }\n            .details { margin: 20px 0; }\n            .row { display: flex; justify-content: space-between; margin: 10px 0; }\n            .label { font-weight: bold; }\n            .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }\n            .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; }\n            @media print { body { margin: 0; } }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <div class="logo">Digital Fleet Management System</div>\n            <h2>Trip Authorization Form</h2>\n          </div>\n          \n          <div class="section">\n            <h3>Trip Information</h3>\n            <div class="row">\n              <span><span class="label">Authorization ID:</span> ${e.id}</span>\n              <span><span class="label">Date Created:</span> ${new Date(e.created_at).toLocaleDateString()}</span>\n            </div>\n            <div class="row">\n              <span><span class="label">Destination:</span> ${e.destination}</span>\n              <span><span class="label">Purpose:</span> ${e.purpose}</span>\n            </div>\n            <div class="row">\n              <span><span class="label">Departure Date:</span> ${new Date(e.departure_date).toLocaleDateString()}</span>\n              <span><span class="label">Expected Return:</span> ${new Date(e.return_date).toLocaleDateString()}</span>\n            </div>\n          </div>\n\n          <div class="section">\n            <h3>Driver Information</h3>\n            <div class="row">\n              <span><span class="label">Driver Name:</span> ${e.driver_name}</span>\n              <span><span class="label">License Number:</span> ${e.driver_license}</span>\n            </div>\n          </div>\n\n          <div class="section">\n            <h3>Vehicle Information</h3>\n            <div class="row">\n              <span><span class="label">Vehicle Registration:</span> ${e.vehicle_registration}</span>\n              <span><span class="label">Authorized Fuel:</span> ${e.fuel_required} Litres</span>\n            </div>\n            <div class="row">\n              <span><span class="label">Estimated Distance:</span> ${e.estimated_distance} km</span>\n            </div>\n          </div>\n\n          ${e.additional_notes?`\n          <div class="section">\n            <h3>Additional Notes</h3>\n            <p>${e.additional_notes}</p>\n          </div>\n          `:""}\n\n          <div class="footer">\n            <p><strong>Digital Fleet Management System</strong></p>\n            <p>Printed on: ${(new Date).toLocaleString()}</p>\n          </div>\n        </body>\n        </html>\n      `;s.document.write(a),s.document.close(),s.focus(),setTimeout(()=>{s.print()},250),T.success("Print window opened successfully!")}catch(s){console.error("Print error:",s),T.error("Failed to open print window. Please try again.")}})(s),className:"text-blue-600 hover:text-blue-700",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Print"]}),e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>B(s),children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),"View Details"]})]})]})})},s.id)),0===P.length&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(C,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No trip records found"}),e.jsx("p",{className:"text-sm",children:"Create a trip record to get started"})]})]})})]})}),e.jsx(o,{value:"reports",children:e.jsx(q,{workTickets:P})})]})})}),e.jsx(u,{open:!!K,onOpenChange:()=>B(null),children:e.jsxs(v,{className:"max-w-2xl",children:[e.jsx(j,{children:e.jsx(b,{children:"Trip Record Details"})}),K&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Driver"}),e.jsx("p",{className:"font-medium",children:K.driver_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vehicle"}),e.jsx("p",{className:"font-medium",children:K.vehicle_registration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Destination"}),e.jsx("p",{children:K.destination})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Purpose"}),e.jsx("p",{children:K.purpose})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Fuel Required"}),e.jsxs("p",{children:[K.fuel_required,"L"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Estimated Distance"}),e.jsxs("p",{children:[K.estimated_distance,"km"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Departure Date"}),e.jsx("p",{children:new Date(K.departure_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Return Date"}),e.jsx("p",{children:new Date(K.return_date).toLocaleDateString()})]})]}),K.additional_notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Additional Notes"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded",children:K.additional_notes})]}),e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsx(a,{variant:"outline",onClick:()=>B(null),children:"Close"})})]})]})})]})}function q({workTickets:a}){const[l,d]=s.useState((new Date).toISOString().slice(0,7)),[c,o]=s.useState("all"),p=(e,s,a)=>{const t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],r=[];for(let i=0;i<7;i++){const n=new Date(e);n.setDate(e.getDate()+i);const l=n.getMonth()===s&&n.getFullYear()===a;r.push({name:t[i],date:new Date(n),dayOfMonth:n.getDate(),isInCurrentMonth:l})}return r},x=(e,s)=>!!e.trips&&e.trips.some(e=>{const a=new Date(e.departure_date),t=new Date(a.getFullYear(),a.getMonth(),a.getDate()),r=new Date(s.getFullYear(),s.getMonth(),s.getDate());return t.getTime()===r.getTime()}),u=(()=>{const e=a.filter(e=>{const s=new Date(e.departure_date).toISOString().slice(0,7)===l,a="all"===c||e.driver_id===c;return s&&a});console.log("Filtered tickets for trip analysis:",e.length,"for month:",l,"and driver:",c);const s=e.reduce((e,s)=>{const a=s.driver_id,t=s.driver_name||"Unknown Driver";return e[a]||(e[a]={driverId:a,driverName:t,trips:[],totalTrips:0}),e[a].trips.push(s),e[a].totalTrips+=1,e},{}),t=Object.values(s);return console.log("Driver trips analysis result:",t),t})(),g=(()=>{const[e,s]=l.split("-").map(Number),a=e,t=s-1,r=new Date(a,t,1),i=new Date(a,t+1,0),n=[];let d=new Date(r);for(d.setDate(r.getDate()-r.getDay()+1);d<=i;){const e=new Date(d);e.setDate(d.getDate()+6);e>=r&&d<=i&&n.push({weekStart:new Date(d),weekEnd:new Date(e),days:p(d,t,a)}),d.setDate(d.getDate()+7)}return console.log(`Generated ${n.length} weeks for ${l}:`,n.map(e=>`${e.weekStart.getDate()}-${e.weekEnd.getDate()}`)),n})(),v=a.reduce((e,s)=>(e.find(e=>e.id===s.driver_id)||e.push({id:s.driver_id,name:s.driver_name}),e),[]),[j,b]=l.split("-").map(Number),N=0===u.length?(()=>{const e=[{driverId:"sample-1",driverName:"John Smith (Sample)",trips:[{departure_date:`${j}-${String(b).padStart(2,"0")}-05`,return_date:`${j}-${String(b).padStart(2,"0")}-05`},{departure_date:`${j}-${String(b).padStart(2,"0")}-12`,return_date:`${j}-${String(b).padStart(2,"0")}-12`},{departure_date:`${j}-${String(b).padStart(2,"0")}-18`,return_date:`${j}-${String(b).padStart(2,"0")}-18`}],totalTrips:3},{driverId:"sample-2",driverName:"Mary Wanjiku (Sample)",trips:[{departure_date:`${j}-${String(b).padStart(2,"0")}-03`,return_date:`${j}-${String(b).padStart(2,"0")}-03`},{departure_date:`${j}-${String(b).padStart(2,"0")}-15`,return_date:`${j}-${String(b).padStart(2,"0")}-15`}],totalTrips:2}];if("all"===c)return e;{const s=e.find(e=>e.driverId===c);if(s)return[s];{const s={...e[0]},a=v.find(e=>e.id===c);return a&&(s.driverName=`${a.name} (Sample)`,s.driverId=c),[s]}}})():u,y=u.length>0?u:N;return e.jsxs(i,{className:"bg-white shadow-xl border border-gray-200 mt-6",children:[e.jsxs(m,{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white",children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-6 w-6"}),"Monthly Trip Management Report"]}),e.jsx("p",{className:"text-white/90 text-sm mt-1",children:"Driver trip analysis with weekly breakdown and daily tracking"})]}),e.jsxs(n,{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"month-select",children:"Select Month"}),e.jsx(r,{id:"month-select",type:"month",value:l,onChange:e=>d(e.target.value),className:"w-40"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"driver-select",children:"Select Driver"}),e.jsxs(_,{value:c,onValueChange:o,children:[e.jsx(w,{className:"w-48",children:e.jsx(D,{})}),e.jsxs(S,{children:[e.jsx(k,{value:"all",children:"All Drivers"}),v.map(s=>e.jsx(k,{value:s.id,children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsx("strong",{children:"Debug Info:"})," Work Tickets: ",a.length,", Drivers: ",v.length,", Filtered Trips: ",u.length,", Selected Month: ",l,", Selected Driver: ","all"===c?"All Drivers":v.find(e=>e.id===c)?.name||c,0===u.length&&" (Showing Sample Data)"]}),y.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-600",children:[e.jsx("strong",{children:"Trip Dates Found:"})," ",y.map(e=>`${e.driverName}: [${e.trips.map(e=>e.departure_date).join(", ")}]`).join(" | ")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Active Drivers"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:y.length})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Total Trips"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:y.reduce((e,s)=>e+s.totalTrips,0)})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Avg Trips/Driver"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:y.length>0?Math.round(y.reduce((e,s)=>e+s.totalTrips,0)/y.length*10)/10:0})]})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden shadow-sm",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left font-semibold text-gray-900",children:"Driver Name"}),e.jsx("th",{className:"border border-gray-200 px-4 py-3 text-center font-semibold text-gray-900",children:"Total Trips"}),g.map((s,a)=>e.jsxs("th",{className:"border border-gray-200 px-2 py-3 text-center font-semibold text-gray-900",children:[e.jsxs("div",{className:"text-xs",children:["Week ",a+1]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[s.weekStart.getDate(),"-",s.weekEnd.getDate()]})]},a))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-2"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2"}),g.map((s,a)=>e.jsx("th",{className:"border border-gray-200 px-1 py-2",children:e.jsx("div",{className:"grid grid-cols-7 gap-1 text-xs",children:s.days.map((s,a)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium "+(s.isInCurrentMonth?"text-gray-700":"text-gray-300"),children:s.name}),e.jsx("div",{className:"text-xs mt-1 "+(s.isInCurrentMonth?"text-gray-600":"text-gray-300"),children:s.dayOfMonth})]},a))})},a))]})]}),e.jsx("tbody",{children:y.map((s,a)=>e.jsxs("tr",{className:a%2==0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"border border-gray-200 px-4 py-3 font-medium text-gray-900",children:s.driverName||`Driver ${a+1}`}),e.jsx("td",{className:"border border-gray-200 px-4 py-3 text-center",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-semibold",children:s.totalTrips})}),g.map((a,t)=>e.jsx("td",{className:"border border-gray-200 px-1 py-3",children:e.jsx("div",{className:"grid grid-cols-7 gap-1",children:a.days.map((a,t)=>e.jsx("div",{className:"flex justify-center items-center h-6",children:a.isInCurrentMonth&&x(s,a.date)?e.jsx(E,{className:"h-4 w-4 text-green-600"}):a.isInCurrentMonth?e.jsx("div",{className:"w-4 h-4"}):e.jsx("div",{className:"w-4 h-4 opacity-30"})},t))})},t))]},s.driverId||`sample-${a}`))})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Trip Day"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"No Trip"})]})]})]})]})]})}function V({onTicketStatusChange:s}={}){return e.jsx(R,{onTicketStatusChange:s})}export{V as WorkTicketManagement};
