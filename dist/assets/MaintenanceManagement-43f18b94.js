import{j as e,W as s,D as r,P as t,F as a,k as i,u as l,m as n,v as c,a as o,l as d}from"./ui-1c32109a.js";import{r as x}from"./vendor-4f48b5c9.js";import{h as m,L as h,I as g,B as p,C as u,a as j,b as v,c as b,d as f}from"./index-6a75618c.js";import{T as y,D as w,a as N,b as C,c as S,d as k}from"./textarea-cf89bf64.js";import{S as D,a as R,b as T,c as P,d as I}from"./select-955880ab.js";import{R as M,B as L,C as F,X as $,Y as A,T as _,a as E}from"./BarChart-69b78874.js";const U=x.memo(function(){const[U,V]=x.useState([]),[q,O]=x.useState([]),[K,W]=x.useState(!1),[B,H]=x.useState("all"),[z,G]=x.useState("all"),[X,Y]=x.useState(""),[J,Q]=x.useState("all"),[Z,ee]=x.useState({vehicleId:"",maintenanceType:"routine",serviceProvider:"",workDescription:"",partsReplaced:"",cost:0,laborCost:0,partsCost:0,mileage:0,date:"",nextServiceDate:"",nextServiceMileage:0,status:"scheduled",priority:"medium",warrantyInfo:"",notes:""}),se=e=>{const s={routine:{showPartsReplaced:!0,showLaborCost:!0,showPartsCost:!0,showWarranty:!0,showNextService:!0,requiredFields:["serviceProvider","workDescription","laborCost","partsCost"],description:"Regular scheduled maintenance like oil changes, filter replacements, etc."},repair:{showPartsReplaced:!0,showLaborCost:!0,showPartsCost:!0,showWarranty:!0,showNextService:!1,requiredFields:["serviceProvider","workDescription","laborCost"],description:"Fixing specific issues or breakdowns"},emergency:{showPartsReplaced:!0,showLaborCost:!0,showPartsCost:!0,showWarranty:!1,showNextService:!1,requiredFields:["serviceProvider","workDescription","laborCost"],description:"Urgent repairs needed to get vehicle operational"},inspection:{showPartsReplaced:!1,showLaborCost:!0,showPartsCost:!1,showWarranty:!1,showNextService:!0,requiredFields:["serviceProvider","workDescription"],description:"Safety inspections, compliance checks, assessments"}};return s[e]||s.routine};x.useEffect(()=>{re(),te()},[]),x.useEffect(()=>{const e=se(Z.maintenanceType);let s=Z.laborCost||0;e.showPartsReplaced&&Z.partsCost&&(s+=Z.partsCost),ee(e=>({...e,cost:s}))},[Z.laborCost,Z.partsCost,Z.maintenanceType]);const re=x.useCallback(async()=>{try{const e=await m.getMaintenanceRecords();V(e||[])}catch(e){}},[]),te=x.useCallback(async()=>{try{const e=await m.getVehicles();O(e||[])}catch(e){}},[]),ae=()=>{ee({vehicleId:"",maintenanceType:"routine",serviceProvider:"",workDescription:"",partsReplaced:"",cost:0,laborCost:0,partsCost:0,mileage:0,date:"",nextServiceDate:"",nextServiceMileage:0,status:"scheduled",priority:"medium",warrantyInfo:"",notes:""})},ie=e=>q.find(s=>s.id===e),le=x.useMemo(()=>{let e=U;return"all"!==B&&(e=e.filter(e=>(e.vehicleId||e.vehicle_id)===B)),"all"!==z&&(e=e.filter(e=>e.status===z)),"all"!==J&&(e=e.filter(e=>e.priority===J)),X&&(e=e.filter(e=>{const s=xe(e),r=ie(s.vehicleId),t=r?`${r.gkNumber} ${r.make} ${r.model}`:"";return(s.workDescription||"").toLowerCase().includes(X.toLowerCase())||(s.serviceProvider||"").toLowerCase().includes(X.toLowerCase())||t.toLowerCase().includes(X.toLowerCase())||de(s.partsReplaced).some(e=>e.toLowerCase().includes(X.toLowerCase()))||(s.notes||"").toLowerCase().includes(X.toLowerCase())})),e.sort((e,s)=>{const r=new Date(e.date||e.service_date||"").getTime();return new Date(s.date||s.service_date||"").getTime()-r})},[U,B,z,J,X]),ne=x.useCallback(()=>le,[le]),ce=e=>{switch(e){case"scheduled":return"bg-blue-500";case"in-progress":return"bg-yellow-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},oe=e=>{switch(e){case"low":return"bg-green-500";case"medium":return"bg-yellow-500";case"high":return"bg-orange-500";case"critical":return"bg-red-500";default:return"bg-gray-500"}},de=e=>e?"string"==typeof e?e.split(",").map(e=>e.trim()).filter(e=>e):Array.isArray(e)?e:[]:[],xe=e=>({id:e.id,vehicleId:e.vehicleId||e.vehicle_id||"",maintenanceType:e.maintenanceType||e.maintenance_type||"routine",serviceProvider:e.serviceProvider||e.service_provider||"",workDescription:e.workDescription||e.description||"",partsReplaced:e.partsReplaced||e.parts_replaced||"",cost:e.cost||0,laborCost:e.laborCost||e.labor_cost||0,partsCost:e.partsCost||e.parts_cost||0,mileage:e.mileage||e.odometer_reading||0,date:e.date||e.service_date||"",nextServiceDate:e.nextServiceDate||e.next_service_date,nextServiceMileage:e.nextServiceMileage||e.next_service_odometer,status:e.status||"scheduled",priority:e.priority||"medium",warrantyInfo:e.warrantyInfo||e.warranty_info,notes:e.notes||"",createdAt:e.createdAt||e.created_at||""}),me=()=>{const e=new Date,s=new Date;return s.setDate(e.getDate()+30),U.filter(r=>{const t=xe(r);return t.nextServiceDate&&new Date(t.nextServiceDate)<=s&&new Date(t.nextServiceDate)>=e})},he=x.useMemo(()=>{const e=U.map(xe),s=e.length,r=e.filter(e=>"completed"===e.status).length,t=e.filter(e=>"in-progress"===e.status).length,a=e.filter(e=>"completed"===e.status).reduce((e,s)=>e+(s.cost||0),0);return{totalRecords:s,completedRecords:r,inProgressRecords:t,totalCost:a,averageCost:r>0?a/r:0}},[U]),ge=x.useCallback(()=>he,[he]),pe=se(Z.maintenanceType),ue=e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),Z.vehicleId&&Z.workDescription&&Z.date)try{const e=q.find(e=>e.id===Z.vehicleId),s={vehicleId:Z.vehicleId,vehicleRegistration:e?.registration||e?.gkNumber||"Unknown",maintenanceType:Z.maintenanceType,description:Z.workDescription,date:Z.date,odometerReading:Z.mileage,cost:Z.cost,vendor:Z.serviceProvider,invoiceNumber:`MAINT-${Date.now()}`,partsReplaced:Z.partsReplaced.split(",").map(e=>e.trim()).filter(e=>e).join(", "),laborHours:Math.round(Z.laborCost/500),warrantyInfo:Z.warrantyInfo,notes:Z.notes,status:Z.status,priority:Z.priority,nextServiceDate:Z.nextServiceDate,nextServiceOdometer:Z.nextServiceMileage},r=await m.createMaintenanceRecord(s);r.success?alert("Maintenance record added successfully!"):alert(`Maintenance record saved (${r.error||"using fallback"})`),W(!1),ae(),re()}catch(s){alert(`Error creating maintenance record: ${s instanceof Error?s.message:"Unknown error"}`)}else alert("Please fill in all required fields")},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"vehicleId",className:"text-gray-700 font-medium",children:"Vehicle*"}),e.jsxs(D,{value:Z.vehicleId,onValueChange:e=>ee({...Z,vehicleId:e}),children:[e.jsx(R,{className:"mt-1 border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:e.jsx(T,{placeholder:"Select a vehicle"})}),e.jsx(P,{children:q.map(s=>e.jsxs(I,{value:s.id,children:[s.registration||s.gkNumber||"Unknown"," - ",s.make," ",s.model]},s.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"maintenanceType",children:"Maintenance Type*"}),e.jsxs(D,{value:Z.maintenanceType,onValueChange:e=>ee({...Z,maintenanceType:e}),children:[e.jsx(R,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(I,{value:"routine",children:"Routine Maintenance"}),e.jsx(I,{value:"repair",children:"Repair"}),e.jsx(I,{value:"emergency",children:"Emergency"}),e.jsx(I,{value:"inspection",children:"Inspection"})]})]}),Z.maintenanceType&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:se(Z.maintenanceType).description})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"priority",children:"Priority*"}),e.jsxs(D,{value:Z.priority,onValueChange:e=>ee({...Z,priority:e}),children:[e.jsx(R,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(I,{value:"low",children:"Low"}),e.jsx(I,{value:"medium",children:"Medium"}),e.jsx(I,{value:"high",children:"High"}),e.jsx(I,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"serviceProvider",children:"Service Provider*"}),e.jsx(g,{id:"serviceProvider",value:Z.serviceProvider,onChange:e=>ee({...Z,serviceProvider:e.target.value}),placeholder:"Toyota Service Center",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"workDescription",children:"Work Description*"}),e.jsx(y,{id:"workDescription",value:Z.workDescription,onChange:e=>ee({...Z,workDescription:e.target.value}),placeholder:"inspection"===Z.maintenanceType?"Describe the inspection items (safety check, emissions test, etc.)":"emergency"===Z.maintenanceType?"Describe the emergency issue and repairs needed":"Describe the maintenance work to be performed...",required:!0})]}),pe.showPartsReplaced&&e.jsxs("div",{children:[e.jsxs(h,{htmlFor:"partsReplaced",children:["Parts Replaced","routine"===Z.maintenanceType?" (comma-separated)*":" (comma-separated)"]}),e.jsx(g,{id:"partsReplaced",value:Z.partsReplaced,onChange:e=>ee({...Z,partsReplaced:e.target.value}),placeholder:"Oil filter, brake pads, air filter",required:"routine"===Z.maintenanceType}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"routine"===Z.maintenanceType?"List all parts replaced during routine maintenance":"List any parts that were replaced during this service"})]}),e.jsxs("div",{className:"grid gap-4 "+(pe.showPartsReplaced?"grid-cols-3":"grid-cols-2"),children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"laborCost",children:"Labor Cost (KES)*"}),e.jsx(g,{id:"laborCost",type:"number",step:"0.01",value:Z.laborCost,onChange:e=>ee({...Z,laborCost:parseFloat(e.target.value)||0}),placeholder:"5000.00",required:!0})]}),pe.showPartsReplaced&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"partsCost",children:"Parts Cost (KES)*"}),e.jsx(g,{id:"partsCost",type:"number",step:"0.01",value:Z.partsCost,onChange:e=>ee({...Z,partsCost:parseFloat(e.target.value)||0}),placeholder:"15000.00",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"cost",children:"Total Cost (KES)"}),e.jsx(g,{id:"cost",type:"number",step:"0.01",value:Z.cost,onChange:e=>ee({...Z,cost:parseFloat(e.target.value)||0}),placeholder:"20000.00",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"mileage",children:"Current Mileage (km)*"}),e.jsx(g,{id:"mileage",type:"number",value:Z.mileage,onChange:e=>ee({...Z,mileage:parseInt(e.target.value)||0}),placeholder:"45000",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"date",children:"Service Date*"}),e.jsx(g,{id:"date",type:"date",value:Z.date,onChange:e=>ee({...Z,date:e.target.value}),required:!0})]})]}),pe.showNextService&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"nextServiceDate",children:"Next Service Date"}),e.jsx(g,{id:"nextServiceDate",type:"date",value:Z.nextServiceDate,onChange:e=>ee({...Z,nextServiceDate:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"nextServiceMileage",children:"Next Service Mileage (km)"}),e.jsx(g,{id:"nextServiceMileage",type:"number",value:Z.nextServiceMileage,onChange:e=>ee({...Z,nextServiceMileage:parseInt(e.target.value)||0}),placeholder:"50000"})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"status",children:"Status*"}),e.jsxs(D,{value:Z.status,onValueChange:e=>ee({...Z,status:e}),children:[e.jsx(R,{children:e.jsx(T,{})}),e.jsxs(P,{children:[e.jsx(I,{value:"scheduled",children:"Scheduled"}),e.jsx(I,{value:"in-progress",children:"In Progress"}),e.jsx(I,{value:"completed",children:"Completed"}),e.jsx(I,{value:"cancelled",children:"Cancelled"})]})]})]}),pe.showWarranty&&e.jsxs("div",{children:[e.jsx(h,{htmlFor:"warrantyInfo",children:"Warranty Information"}),e.jsx(g,{id:"warrantyInfo",value:Z.warrantyInfo,onChange:e=>ee({...Z,warrantyInfo:e.target.value}),placeholder:"6 months or 10,000 km"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"notes",children:"Notes"}),e.jsx(y,{id:"notes",value:Z.notes,onChange:e=>ee({...Z,notes:e.target.value}),placeholder:"Additional information about the maintenance..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>{W(!1),ae()},className:"hover:bg-gray-100 transition-colors",children:"Cancel"}),e.jsx(p,{type:"submit",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl transition-all duration-200",children:"Add Maintenance Record"})]})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50 p-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 p-3 rounded-xl",children:e.jsx(s,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Maintenance Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage your fleet maintenance operations"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(p,{variant:"outline",onClick:()=>{const e=[["Date","Vehicle","Type","Provider","Description","Cost","Status","Priority"].join(","),...ne().map(e=>{const s=xe(e),r=ie(s.vehicleId),t=r?`${r.gkNumber} - ${r.make} ${r.model}`:s.vehicleId;return[s.date,t,s.maintenanceType,s.serviceProvider,`"${s.workDescription}"`,s.cost,s.status,s.priority].join(",")})].join("\n"),s=new Blob([e],{type:"text/csv"}),r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download=`maintenance-records-${(new Date).toISOString().split("T")[0]}.csv`,t.click(),window.URL.revokeObjectURL(r)},className:"flex items-center gap-2 hover:bg-green-50 hover:border-green-300 hover:text-green-700 transition-all duration-200",children:[e.jsx(r,{className:"h-4 w-4"}),"Export CSV"]}),e.jsxs(w,{open:K,onOpenChange:W,children:[e.jsx(N,{asChild:!0,children:e.jsxs(p,{className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(t,{className:"h-4 w-4"}),"Add Maintenance Record"]})}),e.jsxs(C,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(S,{children:e.jsx(k,{className:"text-2xl font-bold text-gray-900",children:"Add Maintenance Record"})}),ue]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:(()=>{const r=ge();return e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"hover:shadow-lg transition-all duration-300 border-l-4 border-l-blue-500 bg-gradient-to-br from-blue-50 to-white",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Records"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.totalRecords}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"All maintenance entries"})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(a,{className:"h-8 w-8 text-blue-600"})})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-all duration-300 border-l-4 border-l-green-500 bg-gradient-to-br from-green-50 to-white",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold text-green-700",children:r.completedRecords}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Finished services"})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(i,{className:"h-8 w-8 text-green-600"})})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-all duration-300 border-l-4 border-l-amber-500 bg-gradient-to-br from-amber-50 to-white",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"In Progress"}),e.jsx("p",{className:"text-3xl font-bold text-amber-700",children:r.inProgressRecords}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Active maintenance"})]}),e.jsx("div",{className:"bg-amber-100 p-3 rounded-full",children:e.jsx(s,{className:"h-8 w-8 text-amber-600"})})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-all duration-300 border-l-4 border-l-purple-500 bg-gradient-to-br from-purple-50 to-white",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Cost"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-700",children:["KES ",r.totalCost.toLocaleString()]}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Total expenses"})]}),e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(l,{className:"h-8 w-8 text-purple-600"})})]})})})]})})()}),e.jsx(u,{className:"shadow-sm border-0 bg-gradient-to-r from-gray-50 to-white",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative md:col-span-2",children:[e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search maintenance records...",value:X,onChange:e=>Y(e.target.value),className:"pl-10 border-gray-200 focus:border-blue-400 focus:ring-blue-400 transition-colors"})]}),e.jsxs(D,{value:B,onValueChange:H,children:[e.jsx(R,{className:"border-gray-200 focus:border-blue-400 focus:ring-blue-400 transition-colors",children:e.jsx(T,{placeholder:"All Vehicles"})}),e.jsxs(P,{children:[e.jsx(I,{value:"all",children:"All Vehicles"}),q.map(s=>e.jsxs(I,{value:s.id,children:[s.registration||s.gkNumber||"Unknown"," - ",s.make," ",s.model]},s.id))]})]}),e.jsxs(D,{value:z,onValueChange:G,children:[e.jsx(R,{className:"border-gray-200 focus:border-blue-400 focus:ring-blue-400 transition-colors",children:e.jsx(T,{placeholder:"All Status"})}),e.jsxs(P,{children:[e.jsx(I,{value:"all",children:"All Status"}),e.jsx(I,{value:"scheduled",children:"Scheduled"}),e.jsx(I,{value:"in-progress",children:"In Progress"}),e.jsx(I,{value:"completed",children:"Completed"}),e.jsx(I,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs(D,{value:J,onValueChange:Q,children:[e.jsx(R,{className:"border-gray-200 focus:border-blue-400 focus:ring-blue-400 transition-colors",children:e.jsx(T,{placeholder:"All Priorities"})}),e.jsxs(P,{children:[e.jsx(I,{value:"all",children:"All Priorities"}),e.jsx(I,{value:"low",children:"Low"}),e.jsx(I,{value:"medium",children:"Medium"}),e.jsx(I,{value:"high",children:"High"}),e.jsx(I,{value:"critical",children:"Critical"})]})]}),e.jsx(p,{variant:"outline",onClick:()=>{Y(""),H("all"),G("all"),Q("all")},className:"hover:bg-gray-100 transition-colors",children:"Clear Filters"})]})})}),me().length>0&&e.jsxs(u,{className:"border-2 border-orange-200 bg-gradient-to-r from-orange-50 via-amber-50 to-orange-50 shadow-md",children:[e.jsx(v,{className:"pb-3",children:e.jsxs(b,{className:"text-orange-800 flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(c,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold",children:"Upcoming Maintenance"}),e.jsxs("p",{className:"text-sm text-orange-700 font-normal mt-1",children:[me().length," vehicle(s) require maintenance within 30 days"]})]})]})}),e.jsx(j,{children:e.jsx("div",{className:"space-y-3",children:me().map(s=>{const r=ie(s.vehicleId);return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg shadow-sm border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(o,{className:"h-4 w-4 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-orange-900",children:r?`${r.registration||r.gkNumber||"Unknown"} - ${r.make} ${r.model}`:s.vehicleId}),e.jsx("p",{className:"text-sm text-orange-700",children:s.workDescription})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-sm font-medium text-orange-800",children:["Due: ",new Date(s.nextServiceDate).toLocaleDateString()]}),e.jsxs("p",{className:"text-xs text-orange-600",children:[Math.ceil((new Date(s.nextServiceDate).getTime()-(new Date).getTime())/864e5)," days remaining"]})]})]},s.id)})})})]}),e.jsxs(u,{className:"shadow-lg border-0",children:[e.jsx(v,{className:"border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:e.jsxs(b,{className:"flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:e.jsx(s,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl font-bold",children:"Maintenance Records"}),e.jsxs("p",{className:"text-sm text-gray-600 font-normal mt-1",children:[ne().length," record(s) found"]})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:0===ne().length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-full w-24 h-24 mx-auto mb-4 flex items-center justify-center",children:e.jsx(s,{className:"h-12 w-12 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"No maintenance records found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Try adjusting your filters or search terms"})]}):ne().map(r=>{const t=xe(r),a=ie(t.vehicleId),n=(e=>{switch(e){case"routine":return i;case"repair":default:return s;case"emergency":return c;case"inspection":return d}})(t.maintenanceType),o=(e=>{if(!e)return-1;const s=new Date,r=new Date(e).getTime()-s.getTime();return Math.ceil(r/864e5)})(t.nextServiceDate||""),x=(m=o)<0?{level:"overdue",color:"bg-red-500",text:"Overdue"}:m<=7?{level:"urgent",color:"bg-red-500",text:"Due Soon"}:m<=30?{level:"warning",color:"bg-yellow-500",text:"Due This Month"}:m<=60?{level:"normal",color:"bg-blue-500",text:"Scheduled"}:{level:"future",color:"bg-gray-500",text:"Future Service"};var m;const h=(e=>{const s=new Date,r=new Date(e),t=s.getTime()-r.getTime(),a=Math.floor(t/864e5);return 0===a?"Today":1===a?"1 day ago":a<7?`${a} days ago`:a<30?`${Math.floor(a/7)} weeks ago`:a<365?`${Math.floor(a/30)} months ago`:`${Math.floor(a/365)} years ago`})(t.date);return e.jsxs("div",{className:"p-6 border border-gray-200 rounded-xl hover:shadow-lg transition-all duration-300 bg-gradient-to-r from-white to-gray-50 hover:from-blue-50 hover:to-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(n,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900",children:a?`${a.registration||a.gkNumber||"Unknown"}`:t.vehicleId}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a?`${a.make} ${a.model} ${a.year||""}`.trim():"Vehicle Details Unavailable"}),e.jsxs("p",{className:"text-xs text-gray-500 capitalize flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[t.maintenanceType," Maintenance"]}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsx("span",{children:h})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:`${oe(t.priority)} text-white px-3 py-1 text-xs font-medium`,children:t.priority.toUpperCase()}),e.jsx(f,{className:`${ce(t.status)} text-white px-3 py-1 text-xs font-medium`,children:t.status.replace("-"," ").toUpperCase()})]}),t.nextServiceDate&&e.jsx(f,{className:`${x.color} text-white px-3 py-1 text-xs font-medium`,children:x.text})]})]}),e.jsx("div",{className:"mb-6 bg-gradient-to-r from-gray-50 to-blue-50 p-4 rounded-lg border border-gray-100",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Service Provider"}),e.jsx("p",{className:"font-semibold text-gray-900 mb-3",children:t.serviceProvider||"Not specified"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Work Description"}),e.jsx("p",{className:"text-sm text-gray-800 leading-relaxed",children:t.workDescription})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Total Cost"}),e.jsxs("p",{className:"font-bold text-2xl text-green-700 flex items-center gap-1",children:[e.jsx(l,{className:"h-5 w-5"}),"KES ",(t.cost||0).toLocaleString()]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-100 shadow-sm",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Service Date"}),e.jsxs("p",{className:"font-medium text-sm flex items-center gap-1 text-gray-900",children:[e.jsx(d,{className:"h-4 w-4 text-blue-500"}),new Date(t.date).toLocaleDateString()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-100 shadow-sm",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Current Mileage"}),e.jsxs("p",{className:"font-bold text-lg text-gray-900",children:[(t.mileage||0).toLocaleString()," km"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-100 shadow-sm",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Labor Hours"}),e.jsxs("p",{className:"font-medium text-lg text-gray-900",children:[t.laborCost?Math.round(t.laborCost/500):"N/A"," hrs"]})]})]}),t.partsReplaced&&(()=>{const s=de(t.partsReplaced);return s.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-3",children:"Parts Replaced"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((s,r)=>e.jsx(f,{variant:"outline",className:"text-xs bg-blue-50 text-blue-800 border-blue-200 hover:bg-blue-100 transition-colors px-3 py-1",children:s},r))})]})})(),t.nextServiceDate&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"p-4 rounded-lg border-2 "+("overdue"===x.level?"bg-red-50 border-red-200":"urgent"===x.level?"bg-orange-50 border-orange-200":"warning"===x.level?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-gray-800 flex items-center gap-2 mb-1",children:[e.jsx(d,{className:"h-4 w-4"}),"Next Service Scheduled"]}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Due: ",new Date(t.nextServiceDate).toLocaleDateString(),t.nextServiceMileage&&` or at ${(t.nextServiceMileage||0).toLocaleString()} km`]})]}),e.jsxs("div",{className:"text-right",children:[o>=0?e.jsxs("p",{className:"text-lg font-bold text-gray-800",children:[o," days"]}):e.jsxs("p",{className:"text-lg font-bold text-red-600",children:[Math.abs(o)," days overdue"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"remaining"})]})]})})}),t.warrantyInfo&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs text-green-700 font-medium uppercase tracking-wide mb-1",children:"Warranty Information"}),e.jsx("p",{className:"text-sm text-green-800",children:t.warrantyInfo})]})}),t.notes&&e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mb-2",children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-4 rounded-lg leading-relaxed",children:t.notes})]})]},t.id)})})})]}),e.jsxs(u,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-gray-50",children:[e.jsx(v,{className:"border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs(b,{className:"flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(l,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl font-bold",children:"Maintenance Costs by Vehicle"}),e.jsx("p",{className:"text-sm text-gray-600 font-normal mt-1",children:"Total maintenance expenses across your fleet"})]})]})}),e.jsx(j,{className:"p-6",children:e.jsx(M,{width:"100%",height:350,children:e.jsxs(L,{data:(()=>{const e={};return U.forEach(s=>{const r=xe(s);"completed"===r.status&&(e[r.vehicleId]=(e[r.vehicleId]||0)+(r.cost||0))}),Object.entries(e).map(([e,s])=>{const r=ie(e);return{vehicle:r?`${r.gkNumber}`:e,cost:s}})})(),margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx($,{dataKey:"vehicle",stroke:"#6b7280",fontSize:12,tick:{fill:"#6b7280"}}),e.jsx(A,{stroke:"#6b7280",fontSize:12,tick:{fill:"#6b7280"},tickFormatter:e=>`KES ${(e/1e3).toFixed(0)}K`}),e.jsx(_,{formatter:e=>[`KES ${e.toLocaleString()}`,"Cost"],contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),e.jsx(E,{dataKey:"cost",fill:"url(#colorGradient)",radius:[4,4,0,0]}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"#1d4ed8",stopOpacity:.8})]})})]})})})]})]})});export{U as MaintenanceManagement};
